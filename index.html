<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>شركة الإبداع لنقل الأثاث - الدمام</title>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="style.css" />
</head>
<body>

<header class="hero">
  <div class="overlay"></div>
  <div class="content">
    <img id="logo" src="" alt="Logo" style="max-width:150px; margin-bottom:10px;" />
    <h1 id="hero-title">🚚 شركة الإبداع في نقل الأثاث - الدمام 🏡</h1>
    <p id="hero-text">نقل أثاثك صار أسهل وأسرع من أي وقت!</p>
    <a id="phone-link" href="tel:0500000000" class="btn-primary">📞 اتصل الآن</a>
  </div>
</header>

<section class="services">
  <h2>لماذا تختارنا؟</h2>
  <div id="services-list" class="service-list"></div>
</section>

<section class="info">
  <h2>📦 نقل بدون تعب… راحة بالك مسؤوليتنا!</h2>
  <p>📍 نخدم الدمام وكل مدن الشرقية</p>
  <a id="phone-link-2" href="tel:0500000000" class="btn-secondary">📞 اتصل الآن وخلّي الإبداع ينقلك!</a>
</section>

<footer>
  <p>© 2025 شركة الإبداع لنقل الأثاث - الدمام | جميع الحقوق محفوظة</p>
</footer>

<script>
  const sheetURL = "https://docs.google.com/spreadsheets/d/1NZ26Lf349B1DzgCb-2BFRoOJwJEOk3-zkGgUQuL2h0Y/gviz/tq?tqx=out:json";

fetch(sheetURL)
  .then(response => {
    if (!response.ok) {
      throw new Error(`HTTP error! Status: ${response.status}`);
    }
    return response.text();
  })
  .then(data => {
    // Parse Google Visualization API response
    const json = JSON.parse(data.substr(47).slice(0, -2));
    // Use rows[1] for data (rows[0] is headers)
    const row = json.table.rows[1]?.c || [];

    // Map data with fallback values
    const logo = row[0]?.v || "default-logo.png";
    const title = row[1]?.v || "شركة الإبداع لنقل الأثاث";
    const description = row[2]?.v || "نقل أثاثك بسهولة وسرعة!";
    const banner = row[3]?.v || "";
    const phone = row[4]?.v || "0500000000";
    const services = [
      row[5]?.v,
      row[6]?.v,
      row[7]?.v,
      row[8]?.v,
      row[9]?.v
    ].filter(Boolean);
    const infoTitle = row[10]?.v || "نقل بدون تعب";
    const infoText = row[11]?.v || "نخدم الدمام وكل مدن الشرقية";
    const footerText = row[12]?.v || "© 2025 شركة الإبداع لنقل الأثاث";

    // Update DOM
    document.getElementById("logo").src = logo;
    document.getElementById("hero-title").textContent = title;
    document.getElementById("hero-text").textContent = description;
    document.getElementById("phone-link").href = `tel:${phone}`;
    document.getElementById("phone-link-2").href = `tel:${phone}`;
    document.querySelector(".info h2").textContent = infoTitle;
    document.querySelector(".info p").textContent = infoText;
    document.querySelector("footer p").textContent = footerText;

    // Set hero background
    if (banner) {
      document.querySelector(".hero").style.backgroundImage = `url('${banner}')`;
    }

    // Populate services
    const servicesContainer = document.getElementById("services-list");
    servicesContainer.innerHTML = services.length ? "" : "<p>لا توجد خدمات متاحة.</p>";
    services.forEach(service => {
      const div = document.createElement("div");
      div.className = "service";
      div.textContent = service;
      servicesContainer.appendChild(div);
    });
  })
  .catch(err => {
    console.error("Error fetching sheet data:", err);
    document.getElementById("services-list").innerHTML = "<p>عذرًا، تعذر تحميل البيانات. حاول لاحقًا.</p>";
  });
</script>

</body>
</html>
